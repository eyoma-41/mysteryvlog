<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>미스터리 브이로그 — 밈</title>
  <style>
    :root{--border:#e6e8eb;--brand:#ff0033;--text:#111318}
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Pretendard,system-ui,"Noto Sans KR",sans-serif;color:var(--text)}
    .wrap{max-width:1200px;margin:0 auto;padding:16px 16px 88px}
    h1{margin:8px 0 12px}
/* 공통 */
.preview{
  display:block;
  width:100%;
  background:#000;
  border:0;
}

/* 유튜브 등 영상용 */
.video-preview{
  aspect-ratio:16/9;
  height:auto;
  object-fit:cover;
}

/* 이미지용: 잘리지 않게 contain + 세로 최대높이 제한 */
.img-preview{
  width:auto;                /* 이미지가 가로 100%를 초과하면 max-width로 제한 */
  max-width:100%;
  height:auto;
  max-height:calc(100vh - 220px); /* 상단 타이틀/하단 텍스트 여백 고려 */
  margin:0 auto;             /* 가운데 정렬 */
  object-fit:contain;        /* 비율 유지하며 전체 표시 */
}

    /* grid: 2열 → 4열 → 7열 */
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;margin-bottom:10px}
    @media (min-width:720px){ .grid{grid-template-columns:repeat(4,minmax(0,1fr));} }
    @media (min-width:1100px){ .grid{grid-template-columns:repeat(7,minmax(0,1fr));} }

    .card{border:1px solid var(--border);border-radius:14px;padding:10px;background:#fff;text-decoration:none;color:var(--text);display:block}
    .thumb{aspect-ratio:16/9;background:#eee center/cover no-repeat;border-radius:10px}
    .card-title{margin-top:8px;font-weight:700;line-height:1.3}
    .card-meta{color:#6b7280;font-size:12px}

    .caption{font-size:12px;color:#6b7280;text-align:center;margin-top:6px}

    .tabs{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--border);
      display:grid;grid-template-columns:repeat(5,1fr);height:72px}
    .tab{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;font-size:12px;color:#333;text-decoration:none}
    .tab svg{width:22px;height:22px}.tab.active{color:var(--brand);font-weight:800}

    /* Modal */
    .backdrop{position:fixed;inset:0;background:rgba(17,19,24,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
    .backdrop.show{display:flex}
    .modal{width:min(960px,100%);background:#fff;border-radius:16px;border:1px solid var(--border);box-shadow:0 10px 30px rgba(0,0,0,.2);overflow:hidden;cursor:pointer}
    .modal-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border)}
    .modal-title{font-weight:800}
    .modal-body{padding:0}
    .preview{width:100%;aspect-ratio:16/9;background:#000;display:block;object-fit:cover;border:0}

    /* 모달 설명: 굵게/얇게 + 줄바꿈은 HTML 태그로 */
    .modal-desc{padding:14px;border-top:1px solid var(--border);font-size:14px;line-height:1.6;white-space:normal}
    .modal-desc b,.modal-desc strong{font-weight:800}
    .modal-desc .thin{font-weight:300;color:#6b7280}

    .sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>밈</h1>

    <div class="caption">페이지 표기는 《미스터리 브이로그》 초판 1쇄 기준입니다.</div>
<br/>
    <div class="grid" id="memeGrid">
      <!-- 이미지 카드 (raw.githubusercontent.com 경로로 통일) -->
      <a class="card"
         href="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/meme01.png"
         data-title="p.9 감다뒤"
         data-text='<strong>p. 9 예술가병 걸린 기획자가, 재미도 감동도 없으며, 감 다 떨어진 연출로 스스로의 낮은 수준을 증명한, 개망한 콘텐츠’였다.</strong><br><span class="thin">‘감이 다 뒤졌다’는 인터넷 방송 은어로 ‘감다뒤’로 줄여 쓴다. 청소년 소설이라는 장르와 청소년 독자들을 고려하여 ‘감 다 떨어진’으로 수정되었다.</span>'
         data-source="Image"
         data-img="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/meme01.png"
         target="_blank" rel="noopener">
        <div class="thumb" style="background-image:url('https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/meme01.png')"></div>
        <div class="card-title">p.9 감다뒤</div>
        <div class="card-meta">Image</div>
      </a>

      <!-- 유튜브 카드 -->
      <a class="card"
         href="https://www.youtube.com/watch?v=MZcAnvE4gQ4"
         data-title="p136 무… 무슨"
         data-text="p136에서 인물의 당황을 살린 밈. 상황 메모 등을 적어두면 좋음."
         data-source="YouTube" target="_blank" rel="noopener">
        <div class="thumb" style="background-image:url('https://img.youtube.com/vi/MZcAnvE4gQ4/hqdefault.jpg')"></div>
        <div class="card-title">p136 무… 무슨</div>
        <div class="card-meta">YouTube</div>
      </a>

      <!-- 샘플 이미지 카드 -->
      <a class="card"
         href="https://picsum.photos/seed/meme1/1280/720"
         data-title="이미지 밈 샘플"
         data-text="이미지 기반 밈의 설명입니다. 장면, 페이지, 의도 등을 적어두세요."
         data-source="Image" target="_blank" rel="noopener">
        <div class="thumb" style="background-image:url('https://picsum.photos/seed/meme1/640/360')"></div>
        <div class="card-title">이미지 밈 샘플</div>
        <div class="card-meta">Image</div>
      </a>
    </div>
  </div>

  <!-- 하단 탭 -->
  <nav class="tabs" aria-label="하단 메뉴">
    <a class="tab" href="index.html" data-page="dashboard">
      <svg viewBox="0 0 24 24"><path d="M4 12.5a1 1 0 0 1 .4-.8l7-5a1 1 0 0 1 1.2 0l7 5a1 1 0 0 1 .4.8V19a1 1 0 0 1-1 1h-4v-6H9v6H5a1 1 0 0 1-1-1v-6.5Z" fill="currentColor"/></svg>
      대시보드
    </a>
    <a class="tab active" href="meme.html" data-page="meme" aria-current="page">
      <svg viewBox="0 0 24 24"><path d="M3 7h18M7 3v18M3 12h18M3 17h12" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      밈
    </a>
    <a class="tab" href="reference.html">
      <svg viewBox="0 0 24 24"><path d="M5 4h14v16H5zM8 8h8M8 12h8M8 16h8" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      레퍼런스
    </a>
    <a class="tab" href="behind.html">
      <svg viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      비하인드
    </a>
    <a class="tab" href="revenue.html">
      <svg viewBox="0 0 24 24"><path d="M4 18s3-6 8-6 8 6 8 6M10 9a2 2 0 1 0 4 0 2 2 0 0 0-4 0Z" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      수익창출
    </a>
  </nav>

  <!-- Modal -->
  <div class="backdrop" id="backdrop" aria-hidden="true">
    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">제목</div>
      </div>
      <div class="modal-body">
        <div id="modalPreviewContainer"></div>
        <div id="modalDesc" class="modal-desc"></div>
      </div>
    </div>
  </div>

  <script>
    // 유튜브 URL → embed URL (자동재생 X)
    function toYouTubeEmbed(url){
      try{
        const u=new URL(url);
        if(u.hostname.includes('youtube.com')){
          const v=u.searchParams.get('v');
          if(v) return `https://www.youtube.com/embed/${v}`;
        }
        if(u.hostname.includes('youtu.be')){
          const id=u.pathname.slice(1);
          if(id) return `https://www.youtube.com/embed/${id}`;
        }
      }catch(e){}
      return null;
    }

    // 이미지 링크 판별
    function isImageUrl(url){
      return /\.(png|jpe?g|webp|gif|bmp|avif)(\?.*)?$/i.test(url||'');
    }

    const grid=document.getElementById('memeGrid');
    const backdrop=document.getElementById('backdrop');
    const modal=document.getElementById('modal');
    const modalTitle=document.getElementById('modalTitle');
    const modalPreviewContainer=document.getElementById('modalPreviewContainer');
    const modalDesc=document.getElementById('modalDesc');
    let currentIframe=null;

    function openModal({title, href, text, img}){
      modalTitle.textContent = title || '';
      modalDesc.innerHTML = text || '';  // HTML 적용
      modalPreviewContainer.innerHTML = '';
      currentIframe = null;

      const yt = toYouTubeEmbed(href||'');
      const imageUrl = img || (isImageUrl(href) ? href : null);

if (yt) {
  const iframe = document.createElement('iframe');
  iframe.className = 'preview video-preview';   // 영상일 때 전용 클래스
  iframe.src = yt;
  iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
  iframe.referrerPolicy = "strict-origin-when-cross-origin";
  iframe.allowFullscreen = true;
  modalPreviewContainer.appendChild(iframe);
  currentIframe = iframe;
} else if (imageUrl) {
  const image = document.createElement('img');
  image.className = 'preview img-preview';     // 이미지일 때 전용 클래스
  image.src = imageUrl;
  image.alt = title || '이미지 미리보기';
  image.loading = 'lazy';
  modalPreviewContainer.appendChild(image);
} else {
  const empty = document.createElement('div');
  empty.className = 'preview img-preview';
  empty.style.display = 'grid';
  empty.style.placeItems = 'center';
  empty.style.color = '#fff';
  empty.textContent = '미리보기 없음';
  modalPreviewContainer.appendChild(empty);
}

      backdrop.classList.add('show');
      backdrop.setAttribute('aria-hidden','false');
      document.addEventListener('keydown',onKeydown);
    }

    function closeModal(){
      backdrop.classList.remove('show');
      backdrop.setAttribute('aria-hidden','true');
      if(currentIframe){ currentIframe.src='about:blank'; currentIframe=null; }
      document.removeEventListener('keydown',onKeydown);
    }

    function onKeydown(e){ if(e.key==='Escape') closeModal(); }

    // 카드 클릭 → 모달 먼저
    grid.addEventListener('click', (e)=>{
      const a=e.target.closest('a.card');
      if(!a) return;
      e.preventDefault();
      openModal({
        title: a.dataset.title || a.querySelector('.card-title')?.textContent || '',
        href: a.getAttribute('href') || '',
        text: a.dataset.text || '',
        img: a.dataset.img || ''
      });
    });

    // 아무 곳이나 한 번 더 클릭 → 닫기
    backdrop.addEventListener('click', closeModal);
    modal.addEventListener('click', closeModal);
  </script>
</body>
</html>
