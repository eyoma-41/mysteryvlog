<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>미스터리 브이로그 — 레퍼런스</title>
  <style>
    :root{--border:#e6e8eb;--brand:#ff0033;--text:#111318;--muted:#6b7280;--bg:#fff;--shadow:0 10px 30px rgba(0,0,0,.18)}
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Pretendard,system-ui,"Noto Sans KR",sans-serif;color:var(--text);background:var(--bg)}

    .wrap{max-width:1200px;margin:0 auto;padding:16px 16px 96px}
    h1{margin:8px 0 12px}
    .caption{font-size:13px;color:var(--muted);margin-bottom:12px}

    /* 카드: 모바일 1열 / 데스크톱 2열 */
    .grid{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:24px}
    @media (min-width:680px){ .grid{grid-template-columns:repeat(2,minmax(0,1fr));} }

    .card{display:block;border:1px solid var(--border);border-radius:20px;background:#fff;text-decoration:none;color:inherit;overflow:hidden;transition:transform .2s;cursor:pointer}
    .card:hover{transform:translateY(-4px)}
    .thumb{aspect-ratio:16/9;background:#f3f4f6 center/cover no-repeat}
    .card-body{padding:16px}
    .card-title{font-weight:800;font-size:18px;line-height:1.4}
    .card-meta{margin-top:6px;font-size:13px;color:var(--muted)}

/* 기존 .viewer 규칙을 이걸로 교체 */
.viewer{
  position:relative;
  background:#000;
  display:grid;
  place-items:center;
  /* 가용 높이는 JS로 넣어줌 */
  overflow:hidden; /* 초과 영역 안 보이게 (이미지는 contain으로 축소됨) */
}

/* 이미지/영상 공통: 가로는 100%, 세로는 JS가 넣어주는 max-height 안에서 contain */
.viewer img{
  max-width:100%;
  height:auto;
  object-fit:contain;
  background:#000;
}
.viewer iframe{ /* 여전히 16:9 래퍼 안에서 동작 */
  background:#000;
}


    

    
    /* 백드롭 & 모달 */
    .backdrop{position:fixed;inset:0;background:rgba(17,19,24,.55);display:none;align-items:center;justify-content:center;padding:18px;z-index:50}
    .backdrop.show{display:flex}
    .modal{
      width:min(1200px,100%);
      max-height:calc(100vh - 120px);
      background:#000;border:1px solid var(--border);border-radius:20px;
      box-shadow:var(--shadow);
      overflow:auto; /* 아래 텍스트 영역 보이게 */
      display:grid;grid-template-rows:auto 1fr auto
    }
    .modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:#fff;border-bottom:1px solid var(--border)}
    .modal-title{font-weight:900;font-size:18px}

    /* 뷰어: 영상/이미지가 모달을 다 먹지 않게 높이 제한 */
    .viewer{position:relative;background:#000;display:grid;place-items:center;max-height:calc(100vh - 280px)}
    #viewerSlot{width:100%;height:100%;display:flex;align-items:center;justify-content:center}
    .viewer img{max-width:100%;max-height:100%;object-fit:contain;background:#000}

    /* 단일 영상 크게: 16:9 */
    .video-wrap{position:relative;width:100%;background:#000;aspect-ratio:16/9}
    .video-wrap::before{content:"";display:block;padding-top:56.25%}
    .video-wrap iframe{position:absolute;inset:0;border:0;width:100%;height:100%;background:#000}

    /* 이미지 캐러셀 컨트롤 */
    .nav-btn{position:absolute;top:50%;transform:translateY(-50%);border:none;background:rgba(255,255,255,.85);width:50px;height:50px;border-radius:50%;display:grid;place-items:center;cursor:pointer}
    .nav-btn:hover{background:#fff}
    .nav-prev{left:16px}
    .nav-next{right:16px}

    .thumbstrip{display:flex;gap:8px;overflow:auto;padding:8px 12px;background:#0b0b0b;border-top:1px solid rgba(255,255,255,.08)}
    .thumbstrip img{width:90px;height:60px;object-fit:cover;border:2px solid transparent;border-radius:6px;cursor:pointer;opacity:.8}
    .thumbstrip img.active{border-color:var(--brand);opacity:1}

    /* 하단 설명 텍스트 */
    .modal-footer{display:flex;flex-direction:column;align-items:flex-start;gap:10px;padding:14px 0 20px 0;background:#fff;border-top:1px solid var(--border)}
    .counter{font-size:14px;color:var(--muted);padding-left:20px}
    .desc{font-size:15px;line-height:1.7;text-align:left;padding:0 20px;max-width:800px;min-height:120px}
    .desc strong{font-weight:800;color:#111}
    .desc .thin{font-weight:300;color:#6b7280}

    /* 하단 탭 — 다른 페이지와 동일한 SVG 세트 */
    .tabs{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--border);display:grid;grid-template-columns:repeat(5,1fr);height:72px;z-index:40}
    .tab{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;font-size:12px;color:#333;text-decoration:none}
    .tab svg{width:22px;height:22px}
    .tab.active{color:var(--brand);font-weight:800}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>레퍼런스</h1>
    <div class="caption">《미스터리 브이로그》를 지으면서 참고한 레퍼런스들</div>

    <div id="refGrid" class="grid">
      <!-- 예시 1: 단일 이미지 -->
      <a class="card" href="#" role="button"
         data-title="원적산과 대왕암"
         data-text="<strong>원적산과 대왕암</strong><br><span class='thin'>1편 원적산은 〔글리프〕 3호: 김금희〔마음〕에서 홍혁진 에디터가 쓴 「인처니스트 김금희」의 첫 꼭지 ‘원주민은 철마산이라 불러요’ 파트에 등장하는 지명 원적산에서 엠디랩프레스를 샤라웃 하는 의미에서 따왔다. 원통이 고개 전설은 원적산과 관계 없지만 마찬가지로 실재하는 전설이다. 2편의 ‘대왕암’은 역사왜곡 키워드와 엮기 위해 선정했고, 1편의 인천과 거리가 먼 지역을 찾아보다가, 경주의 문무대왕릉으로 결정했다.</span>"
         data-images="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref01.png">
        <div class="thumb" style="background-image:url('https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref01.png')"></div>
        <div class="card-body">
          <div class="card-title">원적산과 대왕암</div>
        </div>
      </a>

      <!-- 예시 2: 여러 이미지(캐러셀) -->
<a class="card" href="#" role="button"
   data-title="고성 운망 해변"
   data-text="<strong>고성 운망 해변</strong><br><span class='thin'>운망은 가상의 지명으로, 외삼촌이 사시던 강원도 고성군 죽왕면 문암진리에서 이름을 따왔다. 애너그램으로 비슷한 이름을 조합하다가 ‘운망’이라는 이름이 나왔고, 세 주인공이 운이 없게도 실패에 실패하면서 운발이 망했다(?)는 뜻과 운이 없더라도 그것이 새로운 세계를 열어주는 기회가 될 수 있다는 의미를 담고 싶었다. 작품 속 묘사는 고성의 동호리 해변과 반암 해수욕장 사이의 이름 없는 해변을 레퍼런스로 삼았다. 깊은 방풍림은 경포대의 방풍림을 레퍼런스로 삼았다.</span>"
   data-images="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref02.png, https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref03.jpg">
  <div class="thumb" style="background-image:url('https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref03.jpg')"></div>
  <div class="card-body">
    <div class="card-title">고성 운망 해변</div>
  </div>
</a>

            <a class="card" href="#" role="button"
         data-title="초보운전과 양양 고속도로"
         data-text="<strong>초보운전과 양양 고속도로</strong><br><span class='thin'>5년째 초보운전 스티커를 떼지 않는 나의 미숙한 운전 경험에서 따왔다. 창을 열고 달리는데 덤프트럭이 지나갈 때 차가 좌우로 휘청이는 경험이 큰 충격으로 남았고, 소설로 이어졌다. 양양 고속도로를 타고 운전해본 적은 없다.</span>"
         data-images="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref04.png">
        <div class="thumb" style="background-image:url('https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref04.png')"></div>
        <div class="card-body">
          <div class="card-title">초보운전과 양양 고속도로</div>
        </div>
      </a>
      
      <a class="card" href="#" role="button"
         data-title="다이빙 엘"
         data-text="<strong>고성 운망 해변</strong><br><span class='thin'>다이빙 엘은 《미스터리 브이로그》의 전신인 딜런 칼슨의 이야기 〈가디언즈 프로젝트〉의 설정을 가져왔다. 칼슨과 칼슨 패밀리가 미스터리 스팟인 ‘다이빙 엘’을 방문하는데 그곳은 프리다이버들의 성지이고, L자 모양으로 된 바위 중 가로로 평평한 기반암 부분은 물 속에 얕게 잠겨 있다는 설정을 가졌다. 기반암에는 깊이를 가늠 못한 다이버들이 머리를 부딪혀 남긴 핏자국이 자욱하다는 서브스토리도 있었으나, 공모전에 맞춰 설정을 단순화 했고 기역 바위가 되었다. 바위의 레퍼런스는 동해의 추암 촛대바위이다. </span>"
         data-images="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref06.jpg, https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref05.png">
        <div class="thumb" style="background-image:url('https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref06.jpg')"></div>
        <div class="card-body">
          <div class="card-title">다이빙 엘</div>
        </div>
      </a>

            <a class="card" href="#" role="button"
         data-title="세 번의 휴게소"
         data-text="<strong>녀석의 컨디션을 고려하여 휴게소를 세 번이나 들르다 보니</strong><br><span class='thin'>서울에서 출발한 오원의 차가 들른 휴게소는 가평휴게소, 홍천휴게소, 내린천휴게소 3곳이다.</span>"
         data-images="https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref07.webp, https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref08.webp, https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref09.webp">
        <div class="thumb" style="background-image:url('https://raw.githubusercontent.com/eyoma-41/mysteryvlog/main/img/ref08.webp')"></div>
        <div class="card-body">
          <div class="card-title">세 번의 휴게소</div>
        </div>
      </a>

                  <a class="card" href="#" role="button"
         data-title="미스터리 유튜브"
         data-text="<strong>미스터리 유튜브</strong><br><span class='thin'>하이드 온 월드 유튜브에 대한 설명을 위해서 참조한 유튜브는 다음과 같다.</span><br/>
<span class='strong'>〈미스터리 유튜브 참고〉  | 유튜브 ‘기묘한 밤’, 유튜브 ‘미스터리튜브’, 유튜브 ‘미스스한 이야기’, 유튜브 ‘숫노루 TV', 유튜브 ‘철멍뭉’, 유튜브 ‘캬랑Kyaryang' </span><br/>
<span class='strong'>〈유튜브 사연 소개/인터뷰 부분 참고〉 | 유튜브 ‘디바제시카DeevaJessica', 유튜브 ‘돌비공포라디오’, 유튜브 ‘쌈무이 공포라디오’</span> <br/>
<span class='strong'>〈유튜브 인트로 인사 부분 참고〉 | 유튜브 ‘우왁굳’, 유튜브 ‘쫀득TV’</span>"
        <div class="card-body">
          <div class="card-title">미스터리 유튜브</div>
        </div>
      </a>

      <!-- 예시 3: 단일 영상(16:9) -->
      <a class="card" href="#" role="button"
         data-title="인트로 영상"
         data-text="<strong>인트로 컷</strong><br>‘헬로 월드’ 인사 후 0.8s에 로고 등장.<br><span class='thin'>비트 2-4-4 전환.</span>"
         data-video="https://www.youtube.com/watch?v=Dz_EkjVNWFU&t=55s">
        <div class="thumb" style="background-image:url('https://img.youtube.com/vi/Dz_EkjVNWFU/hqdefault.jpg')"></div>
        <div class="card-body">
          <div class="card-title">단일 영상 예시</div>
          <div class="card-meta">YouTube · 16:9</div>
        </div>
      </a>
    </div>
  </div>

  <!-- 모달 -->
  <div id="backdrop" class="backdrop" aria-hidden="true">
    <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-header">
        <div id="modalTitle" class="modal-title">제목</div>
        <button class="close-x" id="closeX" aria-label="닫기">
          <svg viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="2" fill="none"/></svg>
        </button>
      </div>

      <div class="viewer">
        <!-- 이미지일 때만 보이는 이전/다음 -->
        <button class="nav-btn nav-prev" id="btnPrev" aria-label="이전">
          <svg viewBox="0 0 24 24"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="2" fill="none"/></svg>
        </button>
        <div id="viewerSlot"></div>
        <button class="nav-btn nav-next" id="btnNext" aria-label="다음">
          <svg viewBox="0 0 24 24"><path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" fill="none"/></svg>
        </button>
      </div>

      <!-- 이미지일 때만 표시 -->
      <div class="thumbstrip" id="thumbstrip" aria-label="썸네일"></div>

      <div class="modal-footer">
        <div class="counter" id="counter">1 / 1</div>
        <div class="desc" id="modalDesc"></div>
      </div>
    </div>
  </div>

  <!-- 하단 탭 (다른 페이지와 통일된 SVG) -->
  <nav class="tabs" aria-label="하단 메뉴">
    <a class="tab" href="index.html">
      <svg viewBox="0 0 24 24"><path d="M4 12.5a1 1 0 0 1 .4-.8l7-5a1 1 0 0 1 1.2 0l7 5a1 1 0 0 1 .4.8V19a1 1 0 0 1-1 1h-4v-6H9v6H5a1 1 0 0 1-1-1v-6.5Z" fill="currentColor"/></svg>
      대시보드
    </a>
    <a class="tab" href="meme.html">
      <svg viewBox="0 0 24 24"><path d="M3 7h18M7 3v18M3 12h18M3 17h12" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      밈
    </a>
    <a class="tab active" href="reference.html" aria-current="page">
      <svg viewBox="0 0 24 24"><path d="M5 4h14v16H5zM8 8h8M8 12h8M8 16h8" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      레퍼런스
    </a>
    <a class="tab" href="behind.html">
      <svg viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      비하인드
    </a>
    <a class="tab" href="revenue.html">
      <svg viewBox="0 0 24 24"><path d="M4 18s3-6 8-6 8 6 8 6M10 9a2 2 0 1 0 4 0 2 2 0 0 0-4 0Z" stroke="currentColor" stroke-width="2" fill="none"/></svg>
      수익창출
    </a>
  </nav>

  <script>
    const grid=document.getElementById('refGrid');
    const backdrop=document.getElementById('backdrop');
    const viewerSlot=document.getElementById('viewerSlot');
    const modalTitle=document.getElementById('modalTitle');
    const modalDesc=document.getElementById('modalDesc');
    const counter=document.getElementById('counter');
    const thumbstrip=document.getElementById('thumbstrip');
    const btnPrev=document.getElementById('btnPrev');
    const btnNext=document.getElementById('btnNext');
    const closeX=document.getElementById('closeX');

    let slides=[]; let idx=0; let currentIframe=null; let isVideo=false;

    function toYouTubeEmbed(url){
      try{
        const u=new URL(url);
        let start='';
        if(u.searchParams.has('t')){
          const t=u.searchParams.get('t').replace('s','');
          start=`?start=${parseInt(t)}`;
        }
        if(u.hostname.includes('youtube.com')){
          const v=u.searchParams.get('v');
          if(v) return {embed:`https://www.youtube.com/embed/${v}${start}`,id:v};
        }
        if(u.hostname.includes('youtu.be')){
          const id=u.pathname.slice(1);
          if(id) return {embed:`https://www.youtube.com/embed/${id}${start}`,id};
        }
      }catch(e){}
      return null;
    }

    const parseList = (attr) => (attr||'').split(',').map(s=>s.trim()).filter(Boolean);
    const parseImages = (a) => parseList(a.dataset.images).map(src=>({src,thumb:src}));

    function mountImage(src){
      viewerSlot.innerHTML=''; currentIframe=null;
      const img=document.createElement('img');
      img.alt='이미지'; img.src=src;
      viewerSlot.appendChild(img);

        fitMedia();  // ★ 이 줄만 추가!
    }

    function mountVideo(url){
      viewerSlot.innerHTML=''; currentIframe=null;
      const yt=toYouTubeEmbed(url);
      const wrap=document.createElement('div'); wrap.className='video-wrap';
      const iframe=document.createElement('iframe');
      iframe.src=yt? yt.embed : url;  // 수동재생(autoplay X)
      iframe.allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
      iframe.referrerPolicy='strict-origin-when-cross-origin';
      iframe.allowFullscreen=true;
      wrap.appendChild(iframe); viewerSlot.appendChild(wrap);
      currentIframe=iframe;

        fitMedia();  // ★ 이 줄만 추가!
    }

    function buildThumbs(){
      thumbstrip.innerHTML='';
      slides.forEach((s,n)=>{
        const t=document.createElement('img');
        t.src=s.thumb; t.alt=`썸네일 ${n+1}`;
        t.addEventListener('click',e=>{e.stopPropagation();show(n)});
        thumbstrip.appendChild(t);
      });
    }

    function show(i){
      if(!slides.length) return;
      idx=(i+slides.length)%slides.length;
      mountImage(slides[idx].src);
      counter.textContent=`${idx+1} / ${slides.length}`;
      [...thumbstrip.querySelectorAll('img')].forEach((el,n)=>el.classList.toggle('active',n===idx));

        fitMedia();  // ★ 이 줄만 추가!
    }

    function openModal(a){
      modalTitle.textContent=a.dataset.title||a.querySelector('.card-title')?.textContent||'';
      modalDesc.innerHTML=a.dataset.text||'';

      const videoUrl=a.dataset.video;
      isVideo=!!videoUrl;

      if(isVideo){
        // 비디오는 캐러셀 요소 숨김
        btnPrev.style.display='none';
        btnNext.style.display='none';
        thumbstrip.style.display='none';
        counter.textContent='';
        slides=[]; mountVideo(videoUrl);
      }else{
        // 이미지 캐러셀
        slides=parseImages(a);
        btnPrev.style.display='';
        btnNext.style.display='';
        thumbstrip.style.display='';
        buildThumbs(); show(0);
      }
      backdrop.classList.add('show');
      backdrop.setAttribute('aria-hidden','false');

        fitMedia(); // ✅ 모달 띄운 후 반응형 사이즈 조정
    }

    function closeModal(){
      backdrop.classList.remove('show');
      backdrop.setAttribute('aria-hidden','true');
      if(currentIframe){currentIframe.src='about:blank';currentIframe=null}
    }

    // 이벤트
    grid.addEventListener('click',e=>{
      const a=e.target.closest('a.card'); if(!a) return;
      e.preventDefault(); openModal(a);
    });
    btnPrev.addEventListener('click',e=>{e.stopPropagation(); if(!isVideo) show(idx-1)});
    btnNext.addEventListener('click',e=>{e.stopPropagation(); if(!isVideo) show(idx+1)});
    closeX.addEventListener('click',e=>{e.stopPropagation(); closeModal()});
    backdrop.addEventListener('click',e=>{ if(e.target===backdrop) closeModal() });
    document.addEventListener('keydown',e=>{
      if(!backdrop.classList.contains('show')) return;
      if(e.key==='Escape') closeModal();
      if(!isVideo){
        if(e.key==='ArrowLeft') show(idx-1);
        if(e.key==='ArrowRight') show(idx+1);
      }
    });

function fitMedia() {
  // 모달 구성 요소 높이 합산 → 사용 가능 높이 계산
  const headerH = document.querySelector('.modal-header')?.offsetHeight || 0;
  const footerH = document.querySelector('.modal-footer')?.offsetHeight || 0;
  const thumbsVisible = thumbstrip && thumbstrip.style.display !== 'none';
  const thumbsH = thumbsVisible ? thumbstrip.offsetHeight : 0;

  // 여유 여백(상하 패딩/그림자 여지)
  const safety = 40;
  const avail = Math.max(240, window.innerHeight - (headerH + footerH + thumbsH + safety));

  // viewer와 내부 미디어에 적용
  const viewer = document.querySelector('.viewer');
  if (viewer) viewer.style.maxHeight = avail + 'px';

  const media = viewerSlot.querySelector('img, iframe');
  if (media) {
    media.style.maxHeight = avail + 'px';
    media.style.maxWidth = '100%';
    media.style.width = 'auto';
  }
}

    window.addEventListener('resize', fitMedia);
  </script>
</body>
</html>
